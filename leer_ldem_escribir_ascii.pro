;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',/dat
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.225_h1_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l4.0_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l2.0_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat
;leer_ldem_escribir_ascii,'LDEM.v3_euviA_cr2198_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',/dat
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l4.0_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat,output='Ne_CR2198_DEMT-AIA_FD-L4._r3D'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l2.0_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat,output='Ne_CR2198_DEMT-AIA_FD-L2._r3D'  
;leer_ldem_escribir_ascii,'LDEM.v3_euviA_cr2198_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',/dat,output='Ne_CR2198_DEMT-EUVI_FD-L.75._r3D'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.45_h1_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat,output='Ne_CR2198_DEMT-AIA_H1-L.45_r3D'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.2_h1_r3d_oldset_reduced_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/dat,output='Ne_CR2198_DEMT-AIA_H1-L.2_r3D_reduced'
;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',/ne_dat,out_ne='Ne_CR2082_DEMT-EUVI_FD-L.75_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',/tm_dat,oout_tm='Tm_CR2082_DEMT-EUVI_FD-L.75_r3d'

;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.225_h1_r3d_oldset_v2_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2082_DEMT-EUVI_H1-L.225_r3d',ne_out='Ne_CR2082_DEMT-EUVI_H1-L.225_r3d',R_out='R_CR2082_DEMT-EUVI_H1-L.225_r3d'   
;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2082_DEMT-EUVI_FD-L.75_r3d',ne_out='Ne_CR2082_DEMT-EUVI_FD-L.75_r3d',R_out='R_CR2082_DEMT-EUVI_FD-L.75_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_cr2081_l0.375_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_FULLHOLLOW_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2081_DEMT-EUVI_FH-L.375_r2d',ne_out='Ne_CR2081_DEMT-EUVI_FH-L.375_r2d',R_out='R_CR2081_DEMT-EUVI_FH-L.375_r2d'
;leer_ldem_escribir_ascii,'LDEM.v3_cr2081_l0.75_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2081_DEMT-EUVI_DEC_FD-L.75_r2d',ne_out='Ne_CR2081_DEMT-EUVI_DEC_FD-L.75_r2d',R_out='R_CR2081_DEMT-EUVI_DEC_FD-L.75_r2d'
;leer_ldem_escribir_ascii,'LDEM.v3_cr2081_l0.75_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_NODECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2081_DEMT-EUVI_NODEC_FD-L.75_r2d',ne_out='Ne_CR2081_DEMT-EUVI_NODEC_FD-L.75_r2d',R_out='R_CR2081_DEMT-EUVI_NODEC_FD-L.75_r2d'

;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.75_fd_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',i_out='CR2082_DEMT-EUVI_FD-L.75_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.225_h1_r3d_oldset_v2_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',i_out='CR2082_DEMT-EUVI_H1-L.225_r3d'   
;leer_ldem_escribir_ascii,'LDEM.v3_cr2082_l0.225_h1_r3d_oldset_v2_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.A_L171_DECON_gauss1_lin_Norm-median_singlStart',/ascii
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.39_h1_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',ne_out='Ne_CR2198_DEMT-AIA_H1-L.39_r3d_bloqueo1.09'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.09_h1_r3d_oldset_reduced_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',ne_out='Ne_CR2198_DEMT-AIA_H1-L.09_r3d_bloqueo1.09_reduced'

;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l0.39_h1_r3d_oldset_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tms_out='Tm_CR2198_DEMT-AIA_H1-L.39_r3d_bloqueo1.09'

;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.34.32.24_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2208_aia_h1',tm_out='Tm_CR2208_aia_h1',ne_out='Ne_CR2208_aia_h1'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.85.80.60_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2208_aia_fd',tm_out='Tm_CR2208_aia_fd',ne_out='Ne_CR2208_aia_fd'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.85.80.60_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2209_aia_fd',tm_out='Tm_CR2209_aia_fd',ne_out='Ne_CR2209_aia_fd'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.85.80.60_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/ascii,tabla='Table_2208_FD.txt'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.85.80.60_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/ascii,tabla='Table_2209_FD.txt'

;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.68.64.48_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2208_aia_h1x2',tm_out='Tm_CR2208_aia_h1x2',ne_out='Ne_CR2208_aia_h1x2'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.17.16.12_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2208_aia_h1x05',tm_out='Tm_CR2208_aia_h1x05',ne_out='Ne_CR2208_aia_h1x02'

;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.9.5.5_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2208_aia_h1_09_05_05',tm_out='Tm_CR2208_aia_h1_09_05_05',ne_out='Ne_CR2208_aia_h1_09_05_05'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.9.5.5_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2209_aia_h1_09_05_05',tm_out='Tm_CR2209_aia_h1_09_05_05',ne_out='Ne_CR2209_aia_h1_09_05_05'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.9.5.5_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/ascii,tabla='Table_2209_Hollow.txt'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.9.5.5_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/ascii,tabla='Table_2208_Hollow.txt'

;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.9.5.5_h1_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_v2_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2209_aia_h1_09_05_05_NS',tm_out='Tm_CR2209_aia_h1_09_05_05_NS',ne_out='Ne_CR2209_aia_h1_09_05_05_NS'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.85.80.60_fd_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_v2_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',R_out='R_CR2209_aia_fd_085_08_06_NS',tm_out='Tm_CR2209_aia_fd_085_08_06_NS',ne_out='Ne_CR2209_aia_fd_085_08_06_NS'

;OBS Estos NS = NewSet y son #define INSTR_RMAX 1.26 #define RMAX1.30 #define RMIN 1.00 #define NRAD 30


;leer_ldem_escribir_ascii,'LDEM.v3_CR2082_l.35.2.3_h1_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_vfullcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2082_DEMT-EUVI_behind_H1-L.35.2.3_r3d',ne_out='Ne_CR2082_DEMT-EUVI_behind_H1-L.35.2.3_r3d',R_out='R_CR2082_DEMT-EUVI_behind_H1-L.35.2.3_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2082_l.25.75.5_fd_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_vfullcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2082_DEMT-EUVI_behind_FD-L.25.75.5_r3d',ne_out='Ne_CR2082_DEMT-EUVI_behind_FD-L.25.75.5_r3d',R_out='R_CR2082_DEMT-EUVI_behind_FD-L.25.75.5_r3d'  

;leer_ldem_escribir_ascii,'LDEM.v3_CR2082_l.35.2.3_h1_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_vfullcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',tabla='Table_2082_H1_V2.txt',/aevs
;leer_ldem_escribir_ascii,'LDEM.v3_CR2082_l.25.75.5_fd_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_vfullcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',tabla='Table_2082_FD_V2.txt',/aevs

;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.5.2.25_FIXED_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2209_DEMT-AIA_H1_fixed-L.5.2.25_r3d',ne_out='Ne_CR2209_DEMT-AIA_H1_fixed-L.5.2.25_r3d',R_out='R_CR2209_DEMT-AIA_H1_fixed-L. 5.2.25_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.25.30.30_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2209_DEMT-AIA_FD_L.25.3.3_r3d',ne_out='Ne_CR2209_DEMT-AIA_FD_L.25.3.3_r3d',R_out='R_CR2209_DEMT-AIA_FD_L.25.3.3_r3d'

;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.50.20.20_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2208_DEMT-AIA_H1_L.5.2.2_r3d',ne_out='Ne_CR2208_DEMT-AIA_H1_L.5.2.2_r3d',R_out='R_CR2208_DEMT-AIA_H1_L.5.2.2_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.25.30.25_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2208_DEMT-AIA_FD_L.25.3.25_r3d',ne_out='Ne_CR2208_DEMT-AIA_FD_L.25.3.25_r3d',R_out='R_CR2208_DEMT-AIA_FD_L.25.3.25_r3d'
;--------
;ENVIADO A UMICH
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.5.2.25_FIXED_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tabla='Table_2209_Hollow_V2.txt',/aevs 
;leer_ldem_escribir_ascii,'LDEM.v3_CR2209_l.25.30.30_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tabla='Table_2209_FD_V2.txt',/aevs
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.50.20.20_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tabla='Table_2208_Hollow_V2.txt',/aevs
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.25.30.25_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',tabla='Table_2208_FD_V2.txt',/aevs
;---------

;------ CECI
;leer_ldem_escribir_ascii,'LDEM.v3_CR2081_l.3.2.3_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_vlowcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2081_DEMT-euvi_H1-L.3.2.3_r3d',ne_out='Ne_CR2081_DEMT-euvi_H1-L.3.2.3_r3d',R_out='R_CR2081_DEMT-euvi_H1-L.3.2.3_r3d'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2081_l.25.75.5_fd_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_lowcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',tm_out='Tm_CR2081_DEMT-euvi_fd-L.3.2.3_r3d',ne_out='Ne_CR2081_DEMT-euvi_fd-L.3.2.3_r3d',R_out='R_CR2081_DEMT-euvi_fd-L.3.2.3_r3d'
;------

;------ 2198 para Albert
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l.70.90.90_h1_reduced_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',ne_out='Ne_CR2198_DEMT-AIA_H1-L.7.9.9_r3D_reduced'
;leer_ldem_escribir_ascii,'LDEM.v3_CR2198_l.50.35.45_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',ne_out='Ne_CR2198_DEMT-AIA_H1-L.5.35.45_r3D'
;------

;----------- para freswed
;leer_ldem_escribir_ascii,'LDEM.v3_CR2082_l.35.2.3_h1_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_vfullcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',Er_out='Er_CR2082_DEMT-EUVI_behind_H1-L.35.2.3_r3d'
;----------

;---Para testeos paper                                                                                                                                                                                                                        
;leer_ldem_escribir_ascii,'LDEM.v3_CR2082_l.35.2.3_h1_Rmin1.00_Rmax1.30_Nr26_InstRmax1.26_bf4_r3d_B_vfullcadence_chianti.ioneq_sun_coronal_1992_feldman_ext.abund_euvi.B_L171_DECON_gauss1_lin_Norm-median_singlStart',/R_parcial,i_out='_CR2082_DEMT-EUVI_behind_H1-L.35.2.3_r3d'                                                                                                                                                                                                       
;leer_ldem_escribir_ascii,'LDEM.v3_CR2208_l.50.20.20_h1_Rmin1.00_Rmax1.26_Nr26_InstRmax1.26_bf4_r3d_B_chianti.ioneq_sun_coronal_1992_feldman_ext.abundaia3_171_gauss1_lin_Norm-median_singlStart',/R_parcial,i_out='_CR2208_DEMT-EUVI_behind_H1-L.50.20.20_r3d'                                                                                                                                                                                                                           

    

pro leer_ldem_escribir_ascii,file,ascii=ascii,ne_out=ne_out,tm_out=tm_out,R_out=R_out,i_out=i_out,er_out=er_out,tabla=tabla,aevs=aevs
  common results_images,ima,sima,ra,pa,ya,za,em,npx
  common comunes,tm,wt,nband,demc,PHI,parametrizacion,Tmin,Tmax,nr,nth,np,rad,lat,lon,lambda,WTc
  common results_tomo,tfbe,sfbe,N_e
  common demc_extra,demc2,demc3
  common loss_rate,Er
  common fixed_width,sigma
  common fixed_parameter_equalizer,xmax,sigma_v,demv
;i_out es la salida de los R individuales.
;R_out es la salida del R global.
;ascii es la flag para hacer la tabla. 
  read_ldem_albert,file,/ldem,/gauss1 
  ratio=sfbe/tfbe
  R=total( abs(1.-ratio), 4 ) / float(nband)
  ZDA = where(demc eq -999.)


R171=abs(1.-(sfbe(*,*,*,0)/tfbe(*,*,*,0)) )
R195=abs(1.-(sfbe(*,*,*,1)/tfbe(*,*,*,1)) )
R284=abs(1.-(sfbe(*,*,*,2)/tfbe(*,*,*,2)) )

if not keyword_set(aevs) then begin
  AEV = where(demc ne -999. AND (R      gt 0.25  ))
  tm  (AEV) = -666.
  N_e (AEV) = -666.
endif

  R (ZDA)   = -999.
  R171 (ZDA)   = -999.
;  sint171(ZDA)=-999.
;  tomo171(ZDA) =-999.
  R195 (ZDA)   = -999.
  R284 (ZDA)   = -999.

  N_e = float(N_e)
  tm  = float(tm)
  R   = float(R)
  Er  = float(Er)
  R171=float(R171)
  R195=float(R195)
  R284=float(R284)
  if not keyword_set(aevs) then begin
     hdr1='r          lat       long     Te      Ne'
     hdr2='[Rsun]     [deg]     [deg]    [K]   [cm-3]'
  endif
  if  keyword_set(aevs) then begin
     hdr1='r          lat       long     Te      Ne      R'
     hdr2='[Rsun]     [deg]     [deg]    [K]   [cm-3]    []'    
  endif


  if keyword_set(tabla) then begin
;     openw,1,'Table_2082_H1_r3d.txt'
     openw,1,tabla    
     printf,1,'==========================================================================================='
     printf,1,'------------------------------ CR-2082 Behind FD ---------------------------------------------'
;     printf,1,'Hollow - regularization:[0.35, 0.2, 0.3]  - r3d'
     printf,1,'Full Disk - regularization:[0.25, 0.75, 0.5]  - r3d'
     printf,1,' nrad    nlat   nlon'
     printf,1, nr-3-2 , nth , np
     printf,1,hdr1;'r          lat       long     Te      Ne'
     printf,1,hdr2;'[Rsun]     [deg]     [deg]    [K]   [cm-3]'
     for i=2,nr-4 do begin
        for j=0,nth-1 do begin
           for k=0,np-1 do begin

              if not keyword_set(aevs) then begin
                 printf,1, rad(i),lat(j),lon(k),tm(i,j,k),N_e(i,j,k)
              endif 
              if keyword_set(aevs) then begin
                 printf,1, rad(i),lat(j),lon(k),tm(i,j,k),N_e(i,j,k),R(i,j,k)
              endif

           endfor
        endfor
     endfor        
     close,1
     print, ' tabla generada: ' + tabla
  endif
  
;sint171=float(sint171)
;tomo171=float(tomo171)
;  stop
  if keyword_set(ne_out) then begin
     openw,2,ne_out
     writeu,2,N_e
     close,2
  endif
  if keyword_set(tm_out) then begin
     openw,3,tm_out
     writeu,3,tm
     close,3
  endif
  if keyword_set(R_out) then begin
     openw,4,R_out
     writeu,4,R
     close,4
  endif
  if keyword_set(Er_out) then begin
     openw,5,Er_out
     writeu,5,Er
     close,5
  endif
  
  if keyword_set(i_out) then begin
     openw,4,'R171'+i_out
     writeu,4,R171
     close,4

     openw,5,'R195'+i_out
     writeu,5,R195
     close,5
     
     openw,6,'R284'+i_out
    writeu,6,R284
    close,6
  endif
  
  return
end

